name: Simple Todos
schema: "1.0"
version: "1.0.0"
git: https://github.com/isotropy/simple-todos
servers:
  - name: server
    type: http
    build:
      - static
      - client
      - server
    locations:
      - location: /
        type: nodejs
        main: /server/index.js
      - location: /static
        type: static
        path: /static
  - name: auth-server
    type: http
    build:
      - auth-server
    locations:
      - location: /
        type: nodejs
        main: /server/index.js        
builds:
  static:
    type: copy
    dest: /static
  client:
    type: typescript
    bundle: yes
    output: /static/client.js
  server:
    type: typescript
    output: /server  
    connections:
      - type: webdisk
        path: ./disk.ts
        disk: todos
      - type: postgres
        path: ./db.ts
        db: todosdb
      - type: redis
        path: ./redis.ts
        db: todoscache
  auth-server:
    type: typescript
    output: /auth-server  
    connections:
      - type: postgres
        path: ./db.ts
        db: authdb
